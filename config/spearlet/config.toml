# SPEARlet Configuration / SPEARlet 配置

[spearlet]
# Node name (optional) / 节点名称（可选）
node_name = ""
# SMS gRPC address / SMS gRPC地址
sms_grpc_addr = "127.0.0.1:50051"
# SMS HTTP gateway address (for sms+file downloads) / SMS HTTP网关地址（用于sms+file下载）
sms_http_addr = "127.0.0.1:8080"
# Auto register with SMS / 自动向SMS注册
auto_register = true
# Heartbeat interval (seconds) / 心跳间隔（秒）
heartbeat_interval = 30
# Cleanup interval (seconds) / 清理间隔（秒）
cleanup_interval = 300

[spearlet.grpc]
# gRPC bind address / gRPC绑定地址
addr = "0.0.0.0:50052"
# Enable TLS / 启用TLS
enable_tls = false

[spearlet.http]
# Enable CORS / 启用CORS
cors_enabled = true
# Enable Swagger UI / 启用Swagger UI
swagger_enabled = true

[spearlet.http.server]
# HTTP bind address / HTTP绑定地址
addr = "0.0.0.0:8081"

[spearlet.storage]
# Storage backend: "memory" or "sled" / 存储后端："memory" 或 "sled"
backend = "memory"
# Data directory / 数据目录
data_dir = "./data/spearlet"
# Max cache size (MB) / 最大缓存大小（MB）
max_cache_size_mb = 512
# Enable compression / 启用压缩
compression_enabled = true
# Max object size (bytes) / 最大对象大小（字节）
max_object_size = 67108864

[spearlet.logging]
# Log level: trace/debug/info/warn/error / 日志级别
level = "debug"
# Log format: json/pretty / 日志格式
format = "pretty"
# Log output file (optional) / 日志输出文件（可选）
file = "./logs/spearlet.log"

[spearlet.llm]
# Backend routing policy / 后端路由策略
default_policy = "weighted_random"

[[spearlet.llm.credentials]]
# Credential name / 凭据名称
name = "openai_chat"
# v1: env only / v1 仅支持 env
kind = "env"
# Environment variable name that holds the API key / 存放 API key 的环境变量名
api_key_env = "OPENAI_API_KEY"

[[spearlet.llm.credentials]]
name = "openai_realtime"
kind = "env"
api_key_env = "OPENAI_API_KEY"

[[spearlet.llm.backends]]
name = "openai-chat"
kind = "openai_chat_completion"
base_url = "https://api.openai.com/v1"
credential_ref = "openai_chat"
ops = ["chat_completions"]
features = ["supports_tools", "supports_json_schema"]
transports = ["http"]
weight = 100
priority = 0

[[spearlet.llm.backends]]
name = "openai-realtime-asr"
kind = "openai_realtime_ws"
base_url = "https://api.openai.com/v1"
credential_ref = "openai_realtime"
ops = ["speech_to_text"]
features = []
transports = ["websocket"]
weight = 100
priority = 0
